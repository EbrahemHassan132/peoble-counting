# YOLO Person Detection and Monitoring Project

This project uses YOLO (You Only Look Once) for person detection in a video. It includes two main scripts:
- `basic_function.py`: Basic functionality for detecting and counting people in a video, excluding a specified region.
- `extra_features.py`: Enhanced functionality with additional features, such as logging the absence of people in the specified region and toggling monitoring with a button.

## Prerequisites

Before running the scripts, make sure you have the following prerequisites installed:

- Python 3.6+
- OpenCV
- PyTorch
- numpy
- ultralytics
- YOLO model (`yolov10l.pt`)

You can install the required Python packages using pip:

```bash
pip install opencv-python-headless numpy ultralytics
```
**make sure to have CUDA and pytorch compitable with your cuda version.**

## Project Structure

- `basic_function.py`: Contains the basic functionality for detecting and counting people.
- `extra_features.py`: Contains additional features, including logging and toggleable monitoring.
- `AI Intern Video Tech Task.mp4`: The input video file.
- `basic_function_output_video.mp4`: The output video file generated by `basic_function.py`.
- `extra_features_output_video.mp4`: The output video file generated by `extra_features.py`.
- `cashier_monitoring.csv`: CSV file for logging the absence of people in the specified region.
- `people_count.csv`: CSV file for logging the count of people every 5 seconds.

## How to Run the Scripts

### Running `basic_function.py`

1. Place the `AI Intern Video Tech Task.mp4` video file in the same directory as the script.
2. Run the script:

```bash
python basic_function.py
```

### Running `extra_features.py`

1. Place the `AI Intern Video Tech Task.mp4` video file in the same directory as the script.
2. Run the script:

```bash
python extra_features.py
```

### Features in `basic_function.py`

- Loads the YOLO model and opens the video file.
- Defines an excluded region within the video frame.
- Draws a polygon around all the erea except the excluded region.
- Detects people in the video and counts them if they are outside the excluded region.
- Displays the person count on the video frame.
- Saves the output video with bounding boxes and labels.

### Features in `extra_features.py`

- Includes all features from `basic_function.py`.
- Adds logging functionality to record when the specified region is absent of people.
- Adds a button to toggle monitoring on and off.
- Logs the absence of people in the specified region into `cashier_monitoring.csv`.
- Logs the count of people every 5 seconds into `people_count.csv`.

## Output

- The output video file with bounding boxes and labels is saved as `basic_function_output_video.mp4` or `extra_features_output_video.mp4` depending on the script used.
- The absence of people in the specified region is logged in `cashier_monitoring.csv`.
- The count of people every 5 seconds is logged in `people_count.csv`.

## Notes

- Make sure the YOLO model file (`yolov10l.pt`) is in the correct path or modify the script to point to the correct location of the model file.
- The excluded region and other parameters can be adjusted in the script as needed.
